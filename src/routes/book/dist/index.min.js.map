{"version":3,"sources":["index.js"],"names":["_express","_interopRequireDefault","require","db","_interopRequireWildcard","_catchHandle","eResponse","_bookServices","_userServices","_constant","_checklogin","_loaibookServices","_sequelize","_multer","_path","router","express","Router","storage","multer","diskStorage","destination","req","file","cb","filename","fieldname","Date","now","path","extname","originalname","upload","get","res","resAdd","regeneratorRuntime","async","_context","prev","next","awrap","bookServices","sent","log","render","stop","users","findAll","getuser","console","post","_context3","body","findOne","where","phonenumber","abrupt","redirect","userServices","createUser","error","send","_errorByHand","_success","_context4","getSale","getbook","_context5","sales","getbookadmin","query","keySearch","page","listbook","rows","sale","pages","a","current","single","listbookId","objwarehouse","_context6","loaibookId","createBook","image","books","id","String","soluongton","createWarehouse","remove","_context7","bookid","getcategory","_context8","loaibooks","infobook","_context9","loaibookServices","createloaiBook","removetl","_context10","destroy","checklogin","home","_context11","session","params","getBook","Number","book","getsale","getinfo","_context12","bookId","getinfobook","bookcarts","b","_context13","q","_context14"],"mappings":"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","file":"index.min.js","sourcesContent":["import express from 'express'\n\nimport * as db from '../../database/models'\nimport catchHandle from './../../middlewares/catchHandle'\nimport * as eResponse from './../../config/eResponse'\nimport bookServices from '../../webServices/bookServices'\nimport userServices from '../../webServices/userServices'\nimport { BOOK_LIMIT } from '../../config/constant'\nimport checklogin from '../../middlewares/checklogin'\nimport loaibookServices from './../../webServices/loaibookServices'\nimport { Op } from 'sequelize'\nimport multer from 'multer'\nimport path from 'path'\n// import flash from 'express-flash'\n\nconst router = express.Router()\n\nconst storage = multer.diskStorage({\n    destination: function (req, file, cb) {\n        cb(null, './public/uploads/')\n    },\n    filename: function (req, file, cb) {\n        cb(null, file.fieldname + '-' + Date.now() + path.extname(file.originalname))\n        // console.log('asdasf',cb)\n    },\n    \n})\n\nconst upload = multer({storage:storage})\n// console.log('upload', upload)\n\n// const storage = multer.diskStorage({\n//     destination: function (req,file, cb){\n//         cb(null,'./public/uploads/')\n//     },\n//     filename: function (req,file, cb){\n//         cb(null, file.fieldname + '-' + Date.now() + path.extname(file.originalname))\n//     }\n// })\n// const upload = multer({storage:storage})\n\nrouter.get('/admin', catchHandle(async (req,res)=>{\n    // const resAdd = await bookServices.getjoinloaibook()\n    // console.log('abc', resAdd)\n    // res.send(eResponse._success(resAdd))\n    // res.render('index',resAdd)\n    const resAdd = await bookServices.getBook()\n    console.log('abc', resAdd)\n    // res.send(eResponse._success(resAdd))\n    res.render('index')\n}))\n\nrouter.get('/sign-up', catchHandle(async (req,res)=>{\n    const getuser = await db.users.findAll({\n\n    })\n    console.log('abc', getuser)\n    res.render('sign-up',{users:getuser})\n    return getuser;\n}))\n\nrouter.post('/sign-up', catchHandle(async (req,res)=>{\n    console.log(req.body)\n\n    const getuser = await db.users.findOne({\n        where : {\n            phonenumber : req.body.phonenumber\n        }\n    })\n    console.log('o day', getuser)\n    if(getuser){\n        console.log('vao if')\n        // var data = {\n        //     nameinvalid: 'ten da ton tai'\n        // }\n        req.flash('loi', \"có lỗi xảy ra\")\n        return res.redirect('/sign-up')\n    }else{\n        const resAdd = await userServices.createUser(req.body)\n        if(!resAdd || resAdd.error){\n            return res.send(eResponse._errorByHand(!resAdd ? ' System Error' : res.error))\n        }\n        console.log('vao else')\n        return res.redirect('/login').send(eResponse._success(resAdd)) \n    }\n}))\n\nrouter.get('/table',catchHandle( async (req,res) =>{\n    res.render('table')\n}))\n\n\n\n//CREATE BOOK\nrouter.get('/create-book', catchHandle( async (req,res)=>{\n    // const getbook = await db.loaibooks.findAndCountAll({\n    //     include : {\n    //         model : db.books,\n    //         requied: true\n    //     },\n    //     limit : BOOK_LIMIT,\n    //     of\n    // })\n    const getSale = await db.sales.findAll({\n    })\n    const getbook = await bookServices.getbookadmin(req.query.keySearch,req.query.page)\n    // console.log('loai', getbook)\n    // res.send({listbook:getbook.current})\n    res.render('book',{listbook:getbook.rows, sale:getSale, pages : getbook.pages, a: getbook.current})\n    return getbook;\n}))\nrouter.post('/create-book',upload.single('image'),catchHandle( async (req, res)=>{\n\n    // console.log('abc', req.file)\n    console.log(req.body)\n    console.log('hahah', req.body.loaibookId)\n    req.body.image = req.file.filename\n    const resAdd = await bookServices.createBook(req.body,req.body.image)\n    const listbookId = await db.books.findOne({\n        order :\n            [['id', 'desc']]\n        \n    })\n    console.log('reswarehouse', listbookId.id)\n    var objwarehouse = {\n        bookId : String(listbookId.id),\n        soluongton : req.body.soluongton\n    }\n    //Insert warehouse\n    const resAddwarehouse = await bookServices.createWarehouse(objwarehouse)\n    // console.log('abcbac', resAdd)\n    if(!resAdd || resAdd.error){\n        return res.send(eResponse._errorByHand(!resAdd ? ' System Error ' : resAdd.error))\n    }\n\n    // var booksale = {\n    //     bookId : listbookId.id,\n    //     saleId : req.body.saleId\n    // }\n    // //Insert booksale\n    // const resAddbooksale = await bookServices.createbookSale(booksale)\n    res.redirect('/create-book').send(eResponse._success(resAdd))\n\n}))\n\n//Delete Book\nrouter.get('/deletebook', catchHandle(async(req,res)=>{\n    const remove = await db.books.destroy({\n        where :{\n            id : req.query.bookid\n        }\n    })\n    res.send(eResponse._success(remove))\n}))\n\n\n//Create Category\nrouter.get('/create-category', catchHandle( async (req,res)=>{\n    const getcategory = await db.loaibooks.findAll({\n        \n    })\n    // res.send({infobook:getcategory})\n    res.render('categorycreate',{infobook:getcategory})\n}))\nrouter.post('/create-category', catchHandle( async (req,res)=>{\n    console.log(req.body)\n    const resAddCategory = await loaibookServices.createloaiBook(req.body)\n    res.redirect('/create-book')\n}))\n\n//DELETE Category\nrouter.get('/deletecategory',catchHandle(async (req,res)=>{\n    const remove = await db.loaibooks.destroy({\n        where :{\n            id : req.query.id\n        }\n    })\n    const removetl = await db.books.destroy({\n        where : {\n            loaibookId : req.query.id\n        }\n    })\n    res.send(eResponse._success(remove,removetl))\n}))\n\n//VIEW\nrouter.get('/',checklogin,catchHandle(async(req,res)=>{\n    console.log('checklogin', req.session.phone)\n    console.log(req.body)\n    console.log(req.params)\n    console.log(req.query)\n    const home = await bookServices.getBook(req.query.keySearch,req.query.page)\n    // const abc = await bookServices.searchbook(req.query.search)\n    // console.log('ahasd', {abc:home})\n        //Search products \n\n    var a = Number(home.current)\n    console.log('a',a)\n    // res.send(home)\n    // var arr = []\n    // for(var i =0; i <home.rows.length; i++){\n    //     arr.push(home.rows[i].id)\n    // }\n    // console.log(\"aarr\", arr)\n    // res.send({book:home.rows,page: home.pages,a})\n\n    res.render('view',{book:home.rows,page: home.pages,a})\n}))\n\nrouter.get('/thong-tin-book/:bookid', catchHandle( async (req,res)=>{\n    req.session.bookid = req.params.bookid\n    console.log(req.session) \n    const getsale = await db.sales.findOne({\n        where :{\n            bookId : req.params.bookid\n        }\n    })\n\n    const getinfo = await bookServices.getinfobook(req.params.bookid)\n    const getsluong = await db.bookcarts.findAll({\n    })\n    // var tongsoluong = 0\n    // if(getsluong){\n    //     for( var i = 0; i < getsluong.length; i++){\n    //         tongsoluong = tongsoluong + getsluong[i].soluongdat\n    //     }\n    // }\n    // console.log('vao tong soluong', tongsoluong)\n    // console.log('vao day nha', req.session)\n    res.render('infobook',{infobook:getinfo,sale : getsale})\n    // res.send({sale:getsale.sale})\n}))\n\n\n//Search \nrouter.get('/search', catchHandle (async (req,res)=>{\n    console.log(req.query)\n    const home = await bookServices.searchbook(req.query)\n    var a = Number(home.current)\n    var b = req.query.q\n    // console.log('a',a)\n    // res.send({home})\n    res.render('viewsearch',{book:home.rows,page : home.pages,a,b})\n}))\n\n\n\n//test OK\n\nrouter.get('/test', catchHandle(async(req,res)=>{\n    // function primeArray(arr){\n    //     var arr = [1,3,5,7]\n    //     for(var i =0; i <arr.length; i++){\n    //         if(arr[i] == 1){\n    //             return primeArray = false\n    //         }\n    //         else{\n    //             return primeArray = true\n    //         }\n    //     }\n    // }\n    // console.log(primeArray())\n}))\n\n\n\nexport default router"]}