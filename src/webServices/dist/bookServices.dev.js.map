{"version":3,"sources":["bookServices.js"],"names":["cacheTime","createBook","data","loaibookId","error","bookRequestCheck","loai_bookId","image","imageRequire","title","titleRequire","author","authorId","cost","costRequire","db","books","create","getBook","keySearch","pageBook","where","status","Op","substring","console","log","offsets","BOOK_LIMIT","keyCache","cache","get","cacheData","findAndCountAll","include","model","sales","requied","limit","offset","order","pages","Math","ceil","count","current","set","searchbook","attributes","and","startsWith","q","search","getbooks","joinbook","findAll","getinfobook","bookid","findOne","id","infobook","createWarehouse","objwarehouse","warehouses","upsoluongton","obj","update","soluongton","bookId","upsoluongdat","soluongdat","a","bookcarts","userId","upbookcart","createSale","sale","Upsale","namesale","createGiamgia","giamgia","magiamgia","getbookadmin","loaibooks","book"],"mappings":"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","sourcesContent":["\nimport _ from 'lodash'\n\nimport { BOOK_LIMIT,bookRequestCheck, loaibookRequestCheck } from '../config/constant'\nimport { Op } from 'sequelize'\nimport * as db from '../database/models'\nimport * as cache from '../cache'\nimport { xoaDau , removeTagHtml, removeJsScript, checkNameValid } from '../utilities/stringHelpers'\n// import multer from 'multer'\nconst cacheTime = 3600\n\n\n\nconst createBook = async (data)=>{\n    if(!data.loaibookId){\n        return { error : bookRequestCheck.loai_bookId}\n    }\n    data.loaibookId = removeTagHtml(data.loaibookId)\n    if(!data.image){\n        return { error : bookRequestCheck.imageRequire }\n    }\n    data.image = data.image\n    if(!data.title){\n        return { error : bookRequestCheck.titleRequire }\n    }\n    data.title = removeTagHtml(data.title)\n    if(!data.author){\n        return { error : bookRequestCheck.authorId }\n    }\n    data.author = removeTagHtml(data.author)\n    if(!data.cost){\n        return { error : bookRequestCheck.costRequire }\n    }\n    data.cost = removeTagHtml(data.cost)\n\n    return await db.books.create(data)\n}\n\nconst getBook = async (keySearch=false, pageBook =1,data) =>{\n    // const finbook = db.books.findOne({\n    //     limit : BOOK_LIMIT\n    // })\n    // return finbook\n    let where = {\n        title: data,\n        status : 'publish',\n    }\n    if(keySearch) {\n        keySearch = removeTagHtml((xoaDau(keySearch), ' '))\n        where.title = {\n            [Op.substring]: removeTagHtml(keySearch)\n        }\n    }\n    console.log('search',data)\n    if(!pageBook){\n        pageBook =1\n    }\n    const offsets = (pageBook - 1)*BOOK_LIMIT\n\n    const keyCache = '__book_search_keysearch_'+keySearch+'_page_'+pageBook+'_offset_'+offsets\n    console.log('keycache', keyCache)\n    const cacheData = await cache.get(keyCache, true)\n    console.log('cacheData', cacheData)\n    if(cacheData){\n        return cacheData\n    }\n    const books = await db.books.findAndCountAll({\n        // attributes: ['id','loaibookId','image', 'title', 'status', 'author','cost' ,'createdAt', 'updatedAt'],\n\n        where: {\n            // [Op.or]:{\n                status:where.status,\n                // title: {\n                //     [Op.startsWith]: '%'+where.title\n                // }\n            // }\n        },\n        include : {\n            model: db.sales,\n            requied : true\n        },\n        limit: BOOK_LIMIT,\n        offset: offsets,\n        order: [\n          ['id', 'desc']\n        ],\n        // include: [\n        //   {\n        //     model: db.comment,\n        //     where: {\n        //       status: 'publish'\n        //     },\n        //     limit: COMMENT_SUB_LIMIT\n        //   }\n        // ]\n    })\n    books.pages = Math.ceil(books.count/BOOK_LIMIT)\n    books.current = pageBook\n    cache.set(keyCache, books, cacheTime, true)\n    console.log('page', pageBook)\n    \n    // const searchbook = await db.books.findAndCountAll({\n    //     attributes: ['id','loaibookId','image', 'title', 'status', 'author','cost' ,'createdAt', 'updatedAt'],\n    //     where : {\n    //         title: {\n    //             [Op.startsWith]: '%'+where.title\n    //         }\n    //     },\n    //     limit : BOOK_LIMIT,\n    //     offset: offsets,\n    // })\n  \n  return books;\n}\n\n//Search  \nconst searchbook = async (data,pageBook =1) =>{\n    console.log('data', data)\n    // const offsets = (pageBook - 1)*BOOK_LIMIT\n    const search =  await db.books.findAndCountAll({\n        attributes: ['id','loaibookId','image', 'title', 'status', 'author','cost' ,'createdAt', 'updatedAt'],\n        where :{\n            [Op.and]:{\n                status : 'publish',\n                title :{\n                    [Op.startsWith]: '%'+data.q\n                }\n            }\n        },\n        // limit: BOOK_LIMIT,\n        // offset: offsets\n    })\n    // search.pages = Math.ceil(search.count/BOOK_LIMIT)\n    // search.current = pageBook\n    return search;\n}\n\n//Get gia tri de view ra man Home\nconst getbooks = async () =>{\n    const joinbook = db.books.findAll({\n    })\n    return joinbook;\n}\nconst getinfobook = async (bookid) =>{\n    const infobook = await db.books.findOne({\n        where: {\n            id: bookid\n        }\n    })\n    return infobook\n}\n\n//Create Warehouse\nconst createWarehouse = async (objwarehouse) =>{\n    console.log('warehouse', objwarehouse)\n    return await db.warehouses.create(objwarehouse)\n}\n\n//Update Warehouse\nconst upsoluongton = async (obj) =>{\n    console.log('upsoluongton',obj)\n    return await db.warehouses.update(\n        {\n            soluongton : obj.soluongton\n        },\n        {\n            where :{\n                bookId : obj.bookId\n            }\n        }\n    )\n}\n\n//Update BookCarts sop luong \nconst upsoluongdat = async (obj) =>{\n    console.log('obj', obj.soluongdat)\n    let a = obj.soluongdat +1\n    const upbookcart = await db.bookcarts.update(\n        {\n            soluongdat : a\n        },\n        {\n            where : {\n                [Op.and]:[{\n                    bookId : obj.bookId,\n                    userId : obj.userId\n                }                    \n                ]\n            }\n        }\n    )\n}\n\n//Create sale\nconst createSale = async(sale) =>{\n    console.log('createo day', sale)\n    return await db.sales.create(sale)\n}\n// Update sale \nconst Upsale = async (data)=>{\n    console.log(data)\n    return await db.sales.update(\n        {\n            namesale: data.namesale,\n            sale: data.sale\n        },\n        {\n            where :{\n                bookId : data.bookId\n            }\n        }\n    )\n}\n\n//Create Magiamgia \nconst createGiamgia = async(giamgia)=>{\n    console.log('create giamgia ', giamgia)\n    return await db.magiamgia.create(giamgia)\n}\n\n//Create bookSale \n// const createbookSale = async(booksale) =>{\n//     return await db.booksales.create(booksale)\n// }\n\nconst getbookadmin = async(keySearch=false, pageBook=1,data) =>{\n    const offsets = (pageBook - 1)*BOOK_LIMIT\n    console.log(\"offsets\", offsets)\n    const keyCache = '__book_search_keysearch_'+keySearch+'_page_'+pageBook+'_offset_'+offsets\n    console.log('keycache', keyCache)\n    const cacheData = await cache.get(keyCache, true)\n    console.log('cacheData', cacheData)\n\n    const book = await db.loaibooks.findAndCountAll({\n        include : {\n            model : db.books,\n            requied: true,\n        },\n        limit: BOOK_LIMIT,\n        offset : offsets,\n        order :[\n            ['id', 'desc']\n        ]\n    })\n    book.pages = Math.ceil(book.count/BOOK_LIMIT)\n    book.current = pageBook\n    return book\n}\n\nexport default{\n    createBook,\n    getBook,\n    getbooks,\n    getinfobook,\n    searchbook,\n    createWarehouse,\n    upsoluongton,\n    upsoluongdat,\n    createSale,\n    createGiamgia,\n    // createbookSale,\n    Upsale,\n    getbookadmin\n}\n"],"file":"bookServices.dev.js"}