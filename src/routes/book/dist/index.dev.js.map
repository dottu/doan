{"version":3,"sources":["index.js"],"names":["router","express","Router","storage","multer","diskStorage","destination","req","file","cb","filename","fieldname","Date","now","path","extname","originalname","upload","get","res","bookServices","getBook","resAdd","console","log","render","db","users","findAll","getuser","post","body","findOne","where","phonenumber","flash","redirect","userServices","createUser","error","send","eResponse","_errorByHand","_success","sales","getSale","getbookadmin","query","keySearch","page","getbook","listbook","rows","sale","pages","a","current","single","loaibookId","image","createBook","books","order","listbookId","id","objwarehouse","bookId","String","soluongton","createWarehouse","resAddwarehouse","destroy","bookid","remove","loaibooks","getcategory","infobook","loaibookServices","createloaiBook","resAddCategory","removetl","checklogin","session","phone","params","home","Number","book","getsale","getinfobook","getinfo","bookcarts","getsluong","searchbook","b","q"],"mappings":"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","sourcesContent":["import express from 'express'\n\nimport * as db from '../../database/models'\nimport catchHandle from './../../middlewares/catchHandle'\nimport * as eResponse from './../../config/eResponse'\nimport bookServices from '../../webServices/bookServices'\nimport userServices from '../../webServices/userServices'\nimport { BOOK_LIMIT } from '../../config/constant'\nimport checklogin from '../../middlewares/checklogin'\nimport loaibookServices from './../../webServices/loaibookServices'\nimport { Op } from 'sequelize'\nimport multer from 'multer'\nimport path from 'path'\n// import flash from 'express-flash'\n\nconst router = express.Router()\n\nconst storage = multer.diskStorage({\n    destination: function (req, file, cb) {\n        cb(null, './public/uploads/')\n    },\n    filename: function (req, file, cb) {\n        cb(null, file.fieldname + '-' + Date.now() + path.extname(file.originalname))\n        // console.log('asdasf',cb)\n    },\n    \n})\n\nconst upload = multer({storage:storage})\n// console.log('upload', upload)\n\n// const storage = multer.diskStorage({\n//     destination: function (req,file, cb){\n//         cb(null,'./public/uploads/')\n//     },\n//     filename: function (req,file, cb){\n//         cb(null, file.fieldname + '-' + Date.now() + path.extname(file.originalname))\n//     }\n// })\n// const upload = multer({storage:storage})\n\nrouter.get('/admin', catchHandle(async (req,res)=>{\n    // const resAdd = await bookServices.getjoinloaibook()\n    // console.log('abc', resAdd)\n    // res.send(eResponse._success(resAdd))\n    // res.render('index',resAdd)\n    const resAdd = await bookServices.getBook()\n    console.log('abc', resAdd)\n    // res.send(eResponse._success(resAdd))\n    res.render('index')\n}))\n\nrouter.get('/sign-up', catchHandle(async (req,res)=>{\n    const getuser = await db.users.findAll({\n\n    })\n    console.log('abc', getuser)\n    res.render('sign-up',{users:getuser})\n    return getuser;\n}))\n\nrouter.post('/sign-up', catchHandle(async (req,res)=>{\n    console.log(req.body)\n\n    const getuser = await db.users.findOne({\n        where : {\n            phonenumber : req.body.phonenumber\n        }\n    })\n    console.log('o day', getuser)\n    if(getuser){\n        console.log('vao if')\n        // var data = {\n        //     nameinvalid: 'ten da ton tai'\n        // }\n        req.flash('loi', \"có lỗi xảy ra\")\n        return res.redirect('/sign-up')\n    }else{\n        const resAdd = await userServices.createUser(req.body)\n        if(!resAdd || resAdd.error){\n            return res.send(eResponse._errorByHand(!resAdd ? ' System Error' : res.error))\n        }\n        console.log('vao else')\n        return res.redirect('/login').send(eResponse._success(resAdd)) \n    }\n}))\n\nrouter.get('/table',catchHandle( async (req,res) =>{\n    res.render('table')\n}))\n\n\n\n//CREATE BOOK\nrouter.get('/create-book', catchHandle( async (req,res)=>{\n    // const getbook = await db.loaibooks.findAndCountAll({\n    //     include : {\n    //         model : db.books,\n    //         requied: true\n    //     },\n    //     limit : BOOK_LIMIT,\n    //     of\n    // })\n    const getSale = await db.sales.findAll({\n    })\n    const getbook = await bookServices.getbookadmin(req.query.keySearch,req.query.page)\n    // console.log('loai', getbook)\n    // res.send({listbook:getbook.current})\n    res.render('book',{listbook:getbook.rows, sale:getSale, pages : getbook.pages, a: getbook.current})\n    return getbook;\n}))\nrouter.post('/create-book',upload.single('image'),catchHandle( async (req, res)=>{\n\n    // console.log('abc', req.file)\n    console.log(req.body)\n    console.log('hahah', req.body.loaibookId)\n    req.body.image = req.file.filename\n    const resAdd = await bookServices.createBook(req.body,req.body.image)\n    const listbookId = await db.books.findOne({\n        order :\n            [['id', 'desc']]\n        \n    })\n    console.log('reswarehouse', listbookId.id)\n    var objwarehouse = {\n        bookId : String(listbookId.id),\n        soluongton : req.body.soluongton\n    }\n    //Insert warehouse\n    const resAddwarehouse = await bookServices.createWarehouse(objwarehouse)\n    // console.log('abcbac', resAdd)\n    if(!resAdd || resAdd.error){\n        return res.send(eResponse._errorByHand(!resAdd ? ' System Error ' : resAdd.error))\n    }\n\n    // var booksale = {\n    //     bookId : listbookId.id,\n    //     saleId : req.body.saleId\n    // }\n    // //Insert booksale\n    // const resAddbooksale = await bookServices.createbookSale(booksale)\n    res.redirect('/create-book').send(eResponse._success(resAdd))\n\n}))\n\n//Delete Book\nrouter.get('/deletebook', catchHandle(async(req,res)=>{\n    const remove = await db.books.destroy({\n        where :{\n            id : req.query.bookid\n        }\n    })\n    res.send(eResponse._success(remove))\n}))\n\n\n//Create Category\nrouter.get('/create-category', catchHandle( async (req,res)=>{\n    const getcategory = await db.loaibooks.findAll({\n        \n    })\n    // res.send({infobook:getcategory})\n    res.render('categorycreate',{infobook:getcategory})\n}))\nrouter.post('/create-category', catchHandle( async (req,res)=>{\n    console.log(req.body)\n    const resAddCategory = await loaibookServices.createloaiBook(req.body)\n    res.redirect('/create-book')\n}))\n\n//DELETE Category\nrouter.get('/deletecategory',catchHandle(async (req,res)=>{\n    const remove = await db.loaibooks.destroy({\n        where :{\n            id : req.query.id\n        }\n    })\n    const removetl = await db.books.destroy({\n        where : {\n            loaibookId : req.query.id\n        }\n    })\n    res.send(eResponse._success(remove,removetl))\n}))\n\n//VIEW\nrouter.get('/',checklogin,catchHandle(async(req,res)=>{\n    console.log('checklogin', req.session.phone)\n    console.log(req.body)\n    console.log(req.params)\n    console.log(req.query)\n    const home = await bookServices.getBook(req.query.keySearch,req.query.page)\n    // const abc = await bookServices.searchbook(req.query.search)\n    // console.log('ahasd', {abc:home})\n        //Search products \n\n    var a = Number(home.current)\n    console.log('a',a)\n    // res.send(home)\n    // var arr = []\n    // for(var i =0; i <home.rows.length; i++){\n    //     arr.push(home.rows[i].id)\n    // }\n    // console.log(\"aarr\", arr)\n    // res.send({book:home.rows,page: home.pages,a})\n\n    res.render('view',{book:home.rows,page: home.pages,a})\n}))\n\nrouter.get('/thong-tin-book/:bookid', catchHandle( async (req,res)=>{\n    req.session.bookid = req.params.bookid\n    console.log(req.session) \n    const getsale = await db.sales.findOne({\n        where :{\n            bookId : req.params.bookid\n        }\n    })\n\n    const getinfo = await bookServices.getinfobook(req.params.bookid)\n    const getsluong = await db.bookcarts.findAll({\n    })\n    // var tongsoluong = 0\n    // if(getsluong){\n    //     for( var i = 0; i < getsluong.length; i++){\n    //         tongsoluong = tongsoluong + getsluong[i].soluongdat\n    //     }\n    // }\n    // console.log('vao tong soluong', tongsoluong)\n    // console.log('vao day nha', req.session)\n    res.render('infobook',{infobook:getinfo,sale : getsale})\n    // res.send({sale:getsale.sale})\n}))\n\n\n//Search \nrouter.get('/search', catchHandle (async (req,res)=>{\n    console.log(req.query)\n    const home = await bookServices.searchbook(req.query)\n    var a = Number(home.current)\n    var b = req.query.q\n    // console.log('a',a)\n    // res.send({home})\n    res.render('viewsearch',{book:home.rows,page : home.pages,a,b})\n}))\n\n\n\n//test OK\n\nrouter.get('/test', catchHandle(async(req,res)=>{\n    // function primeArray(arr){\n    //     var arr = [1,3,5,7]\n    //     for(var i =0; i <arr.length; i++){\n    //         if(arr[i] == 1){\n    //             return primeArray = false\n    //         }\n    //         else{\n    //             return primeArray = true\n    //         }\n    //     }\n    // }\n    // console.log(primeArray())\n}))\n\n\n\nexport default router"],"file":"index.dev.js"}